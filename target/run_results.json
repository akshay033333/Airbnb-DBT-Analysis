{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.17", "generated_at": "2024-07-11T20:31:25.309177Z", "invocation_id": "209310ca-5d08-497e-bd6f-8b51fe7f912b", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T20:31:24.701033Z", "completed_at": "2024-07-11T20:31:24.703763Z"}, {"name": "execute", "started_at": "2024-07-11T20:31:24.704453Z", "completed_at": "2024-07-11T20:31:24.704464Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005018711090087891, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.firstrepodbt.seed_full_moon_dates", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T20:31:24.706734Z", "completed_at": "2024-07-11T20:31:24.709265Z"}, {"name": "execute", "started_at": "2024-07-11T20:31:24.709903Z", "completed_at": "2024-07-11T20:31:24.709907Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0045659542083740234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.firstrepodbt.scd_raw_listings", "compiled": true, "compiled_code": "\n\nselect * FROM airbnb.raw.raw_listings", "relation_name": "airbnb.DEV.scd_raw_listings"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T20:31:24.712061Z", "completed_at": "2024-07-11T20:31:24.717874Z"}, {"name": "execute", "started_at": "2024-07-11T20:31:24.718428Z", "completed_at": "2024-07-11T20:31:24.718432Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007709026336669922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.firstrepodbt.dim_listing_cleaned", "compiled": true, "compiled_code": "with  __dbt__cte__scr_listing as (\nWITH raw_listings AS (\n    SELECT\n        *\n    FROM airbnb.raw.raw_listings\n)\nSELECT\n    id AS listing_id,\n    name AS listing_name,\n    listing_url,\n    room_type,\n    minimum_nights,\n    host_id,\n    price AS price_str,\n    created_at,\n    updated_at\nFROM\n    raw_listings\n), scr_listing as(\n    select * from __dbt__cte__scr_listing\n)\n\nselect \n    listing_id,\n    listing_name,\n    ROOM_TYPE,\n    case \n    when minimum_nights =0 then 1\n    else minimum_nights end as minimum_nights,\n    host_id,\n    replace(price_str,'$')::Number(\n        10,\n        2\n    ) as price,\n    created_at,\n    updated_at\nfrom \n    scr_listing", "relation_name": "airbnb.raw.dim_listing_cleaned"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T20:31:24.720233Z", "completed_at": "2024-07-11T20:31:24.734833Z"}, {"name": "execute", "started_at": "2024-07-11T20:31:24.735352Z", "completed_at": "2024-07-11T20:31:24.735357Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016206741333007812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.firstrepodbt.fact_reviews_cleaned", "compiled": true, "compiled_code": "\nWITH  __dbt__cte__scr_reviews as (\nwith raw_reviews as(\n    select\n        * \n    from \n        airbnb.raw.raw_reviews\n)\n\n\nselect \n    LISTING_ID,\n    DATE as review_date,\n    REVIEWER_NAME,\n    COMMENTS as review_text,\n    sentiment as review_sentiment\nfrom \n    raw_reviews\n), scr_reviews as (\n    select * from __dbt__cte__scr_reviews\n)\nselect \n md5(cast(coalesce(cast(listing_id as \n    varchar\n), '') || '-' || coalesce(cast(review_date as \n    varchar\n), '') || '-' || coalesce(cast(reviewer_name as \n    varchar\n), '') || '-' || coalesce(cast(review_text as \n    varchar\n), '') as \n    varchar\n)) as review_id,\n * from scr_reviews\nwhere review_text is not null", "relation_name": "airbnb.raw.fact_reviews_cleaned"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T20:31:24.737011Z", "completed_at": "2024-07-11T20:31:24.740658Z"}, {"name": "execute", "started_at": "2024-07-11T20:31:24.741086Z", "completed_at": "2024-07-11T20:31:24.741090Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005106925964355469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.firstrepodbt.dim_hosts_cleaned", "compiled": true, "compiled_code": "with  __dbt__cte__src_hosts as (\nwith src_host as(\n    select\n        * \n    from \n        airbnb.raw.raw_hosts\n)\n\nselect \n    id as host_id,\n    name as host_name,\n    IS_SUPERHOST,\n    created_at,\n    updated_at\nfrom \n    src_host\n), src_hosts as(\n    select * from __dbt__cte__src_hosts \n)\nselect \n    host_id,\n    is_superhost,\n    case when  host_name is not null then host_name\n    else 'Anonymous' end as host_name,\n    created_at,\n    updated_at\nfrom \n    src_hosts", "relation_name": "airbnb.raw.dim_hosts_cleaned"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T20:31:24.742604Z", "completed_at": "2024-07-11T20:31:24.750796Z"}, {"name": "execute", "started_at": "2024-07-11T20:31:24.751262Z", "completed_at": "2024-07-11T20:31:24.751266Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009632110595703125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.firstrepodbt.accepted_values_dim_listing_cleaned_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.572677b2fc", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        room_type as value_field,\n        count(*) as n_records\n\n    from airbnb.raw.dim_listing_cleaned\n    group by room_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Entire home/apt','Private room','Shared room','Hotel room'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T20:31:24.752657Z", "completed_at": "2024-07-11T20:31:25.126874Z"}, {"name": "execute", "started_at": "2024-07-11T20:31:25.128052Z", "completed_at": "2024-07-11T20:31:25.128064Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5014400482177734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.firstrepodbt.no_null_columns_dim_listing", "compiled": true, "compiled_code": "-- singular test for macros example\n\n    SELECT * FROM airbnb.raw.dim_listing_cleaned WHERE\n        LISTING_ID IS NULL OR\n        LISTING_NAME IS NULL OR\n        ROOM_TYPE IS NULL OR\n        MINIMUM_NIGHTS IS NULL OR\n        HOST_ID IS NULL OR\n        PRICE IS NULL OR\n        CREATED_AT IS NULL OR\n        UPDATED_AT IS NULL OR\n        \n FALSE\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T20:31:25.257473Z", "completed_at": "2024-07-11T20:31:25.268095Z"}, {"name": "execute", "started_at": "2024-07-11T20:31:25.268896Z", "completed_at": "2024-07-11T20:31:25.268906Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01362299919128418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.firstrepodbt.not_null_dim_listing_cleaned_listing_id.6ce8cb1d5e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect listing_id\nfrom airbnb.raw.dim_listing_cleaned\nwhere listing_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T20:31:25.271661Z", "completed_at": "2024-07-11T20:31:25.277282Z"}, {"name": "execute", "started_at": "2024-07-11T20:31:25.278011Z", "completed_at": "2024-07-11T20:31:25.278015Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008064746856689453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.firstrepodbt.positive_value_dim_listing_cleaned_minimum_nights.931c828e65", "compiled": true, "compiled_code": "\n    SELECT\n        *\n    FROM\n        airbnb.raw.dim_listing_cleaned\n    WHERE\n        minimum_nights < 1\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T20:31:25.280349Z", "completed_at": "2024-07-11T20:31:25.286156Z"}, {"name": "execute", "started_at": "2024-07-11T20:31:25.286764Z", "completed_at": "2024-07-11T20:31:25.286768Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007860898971557617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.firstrepodbt.unique_dim_listing_cleaned_listing_id.b291a18e9c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    listing_id as unique_field,\n    count(*) as n_records\n\nfrom airbnb.raw.dim_listing_cleaned\nwhere listing_id is not null\ngroup by listing_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T20:31:25.288908Z", "completed_at": "2024-07-11T20:31:25.292528Z"}, {"name": "execute", "started_at": "2024-07-11T20:31:25.293117Z", "completed_at": "2024-07-11T20:31:25.293122Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005606889724731445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.firstrepodbt.mart_full_moon", "compiled": true, "compiled_code": "\n\nWITH fct_reviews AS (\n    SELECT * FROM airbnb.raw.fact_reviews_cleaned\n),\nfull_moon_dates AS (\n    SELECT * FROM airbnb.raw.seed_full_moon_dates\n)\n\nSELECT\n  r.*,\n  CASE\n    WHEN fm.full_moon_date IS NULL THEN 'not full moon'\n    ELSE 'full moon'\n  END AS is_full_moon\nFROM\n  fct_reviews\n  r\n  LEFT JOIN full_moon_dates\n  fm\n  ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))", "relation_name": "airbnb.raw.mart_full_moon"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T20:31:25.295042Z", "completed_at": "2024-07-11T20:31:25.297739Z"}, {"name": "execute", "started_at": "2024-07-11T20:31:25.298253Z", "completed_at": "2024-07-11T20:31:25.298256Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004340171813964844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.firstrepodbt.consistent_created_at", "compiled": true, "compiled_code": "select * from airbnb.raw.dim_listing_cleaned as dl\njoin airbnb.raw.fact_reviews_cleaned as fr on dl.listing_id=fr.listing_id\nwhere fr.review_date<dl.created_at", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T20:31:25.299966Z", "completed_at": "2024-07-11T20:31:25.302827Z"}, {"name": "execute", "started_at": "2024-07-11T20:31:25.303286Z", "completed_at": "2024-07-11T20:31:25.303288Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00438380241394043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.firstrepodbt.dim_lisiting_w_hosts", "compiled": true, "compiled_code": "WITH\nl AS (\n    SELECT\n        *\n    FROM\n        airbnb.raw.dim_listing_cleaned\n),\nh AS (\n    SELECT * \n    FROM airbnb.raw.dim_hosts_cleaned\n)\n\nSELECT \n    l.listing_id,\n    l.listing_name,\n    l.room_type,\n    l.minimum_nights,\n    l.price,\n    l.host_id,\n    h.host_name,\n    h.IS_SUPERHOST as host_is_superhost,\n    l.created_at,\n    GREATEST(l.updated_at, h.updated_at) as updated_at\nFROM l\nLEFT JOIN h ON (h.host_id = l.host_id)", "relation_name": "airbnb.raw.dim_lisiting_w_hosts"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-11T20:31:25.304833Z", "completed_at": "2024-07-11T20:31:25.307011Z"}, {"name": "execute", "started_at": "2024-07-11T20:31:25.307489Z", "completed_at": "2024-07-11T20:31:25.307492Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0036971569061279297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.firstrepodbt.full_moon_no_sleep", "compiled": true, "compiled_code": "WITH fullmoon_reviews AS (\n    SELECT * FROM airbnb.raw.mart_full_moon\n)\nSELECT\n    is_full_moon,\n    review_sentiment,\n    COUNT(*) as reviews\nFROM\n    fullmoon_reviews\nGROUP BY\n    is_full_moon,\n    review_sentiment\nORDER BY\n    is_full_moon,\n    review_sentiment", "relation_name": null}], "elapsed_time": 2.533616065979004, "args": {"quiet": false, "use_colors_file": true, "defer": false, "log_level": "info", "enable_legacy_logger": false, "vars": {}, "partial_parse": true, "populate_cache": true, "use_colors": true, "printer_width": 80, "show_resource_report": false, "favor_state": false, "output": "text", "project_dir": "/Users/akshaykailasa/dbt-project/firstrepodbt", "static_parser": true, "send_anonymous_usage_stats": true, "write_json": true, "log_format": "default", "which": "compile", "profiles_dir": "/Users/akshaykailasa/.dbt", "log_format_file": "debug", "inject_ephemeral_ctes": true, "require_explicit_package_overrides_for_builtin_materializations": false, "warn_error_options": {"include": [], "exclude": []}, "print": true, "strict_mode": false, "exclude": [], "indirect_selection": "eager", "log_file_max_bytes": 10485760, "select": [], "introspect": true, "partial_parse_file_diff": true, "version_check": true, "log_path": "/Users/akshaykailasa/dbt-project/firstrepodbt/logs", "macro_debugging": false, "invocation_command": "dbt compile", "cache_selected_only": false, "log_level_file": "debug"}}